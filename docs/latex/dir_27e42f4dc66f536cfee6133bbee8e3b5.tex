\doxysection{examples/advanced\+\_\+demo/5-\/nvbench Directory Reference}
\hypertarget{dir_27e42f4dc66f536cfee6133bbee8e3b5}{}\label{dir_27e42f4dc66f536cfee6133bbee8e3b5}\index{examples/advanced\_demo/5-\/nvbench Directory Reference@{examples/advanced\_demo/5-\/nvbench Directory Reference}}
Directory dependency graph for 5-\/nvbench\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=183pt]{dir_27e42f4dc66f536cfee6133bbee8e3b5_dep}
\end{center}
\end{figure}


\doxysubsection{Detailed Description}

\begin{DoxyItemize}
\item 1. Introduction
\item 2. Quick Start
\begin{DoxyItemize}
\item 2.1. Build
\begin{DoxyItemize}
\item 2.1.1. Optionally define CUDA arch
\end{DoxyItemize}
\item 2.2. Run
\end{DoxyItemize}
\item 3. nvbench on top of Com\+PPare
\begin{DoxyItemize}
\item 3.1. How to use
\end{DoxyItemize}
\item 4. nvbench CLI
\end{DoxyItemize}

\doxysubsection*{1. Introduction}

nvbench is a provided external plugin. It is like google benchmark, but more geared towards nvidia gpu kernels.

\doxysubsection*{2. Quick Start}

\doxysubsubsection*{2.\+1. Build}


\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir\ build}
\DoxyCodeLine{cd\ build}
\DoxyCodeLine{cmake\ ..\ -\/DCMAKE\_BUILD\_TYPE=Release}
\DoxyCodeLine{make\ }

\end{DoxyCode}


\doxysubsubsubsection*{2.\+1.\+1. Optionally define CUDA arch}


\begin{DoxyCode}{0}
\DoxyCodeLine{cmake\ ..\ -\/DCUDA\_ARCH=80}

\end{DoxyCode}


\doxysubsubsection*{2.\+2. Run}


\begin{DoxyCode}{0}
\DoxyCodeLine{./saxpy\_nvbench}

\end{DoxyCode}


\doxysubsection*{3. nvbench on top of Com\+PPare}

\doxysubsubsection*{3.\+1. How to use}

Use {\ttfamily GPU\+\_\+\+HOTLOOPSTART/\+END} to mark the region you want to benchmark.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ saxpy\_gpu(\textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ a,\ \textcolor{keyword}{const}\ std::vector<float>\ x,\ \textcolor{keyword}{const}\ std::vector<float>\ y,\ std::vector<float>\ y\_out)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{/*\ Setup\ */}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ GPU\_HOTLOOPSTART;}
\DoxyCodeLine{\ \ \ \ saxpy<<<numBlocks,\ blockSize>>>(a,\ d\_x,\ d\_y,\ d\_y\_out,\ n);}
\DoxyCodeLine{\ \ \ \ GPU\_HOTLOOPEND;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{/*\ Cleanup\ */}}
\DoxyCodeLine{\}}

\end{DoxyCode}


To attach to nvbench, simply add {\ttfamily .nvbench()}\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{cmp.add(\textcolor{stringliteral}{"{}saxpy\ gpu"{}},\ saxpy\_gpu).nvbench();}

\end{DoxyCode}


You can also add nvbench options like\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{cmp.add(\textcolor{stringliteral}{"{}saxpy\ cpu"{}},\ saxpy\_cpu).nvbench().set\_is\_cpu\_only(\textcolor{keyword}{true});}

\end{DoxyCode}


\doxysubsection*{4. nvbench CLI}

nvbench has CLI arguments. To use them, add prefix {\ttfamily -\/-\/nvbench} to the argument. For instance to set the throttle threshold of the gpu\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{./saxpy\_nvbench\ -\/-\/nvbench="{}-\/-\/throttle-\/threshold\ 20"{}\ -\/-\/iters\ 1000\ -\/-\/warmups\ 1000}

\end{DoxyCode}


Only {\ttfamily -\/-\/throttle-\/threshold 20} will be passed into nvbench\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*}
\DoxyCodeLine{=============\ nvbench\ =============}
\DoxyCodeLine{*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*}
\DoxyCodeLine{}
\DoxyCodeLine{nvbench\ cmdline\ arguments:}
\DoxyCodeLine{\ \ \ \ [0]\ "{}./saxpy\_nvbench"{}}
\DoxyCodeLine{\ \ \ \ [1]\ "{}-\/-\/throttle-\/threshold"{}}
\DoxyCodeLine{\ \ \ \ [2]\ "{}20"{}}
\DoxyCodeLine{*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*}

\end{DoxyCode}
 
